<!--pages/party/partydetailpage/partydetailpage.wxml-->
<!-- <view>
<van-button color="#ff9100" class="returnbutton">单色按钮</van-button>
</view> -->
<page-meta>
  <navigation-bar background-color="#1a237e"></navigation-bar>
</page-meta>
<view class="wrapper">

  <!-- 卡片：拼局详情 -->
  <view class="partydetailview">

    <view class="party-detail-bar">
      <text class="partydetailtitle">拼局详情</text>
      <image src="../../../static/icons/more.png" class="more" id="morebutton" bindtap="onTap"></image>
      <!-- '更多'弹出框 -->
      <v-popover id='popover'>
        <v-popover-item bindtap='editParty' hasline>修改</v-popover-item>
        <v-popover-item bindtap='disbandParty' hasline>解散</v-popover-item>
      </v-popover>
      <van-dialog id="van-dialog" />
    </view>

    <!-- 头像显示 -->
    <v-name-card class="user-message" publisherMsg="{{partyPublisherMsg}}" userId="{{partyPublisherID}}" publisherTime="{{partyCreateTime}}" ></v-name-card>

    <view class="partydetailcontent">
      {{partyDetailContent}}
    </view>

    <!-- 图片 -->
    <view class="party-detail-img-view">
      <image class="party-detail-img" src="http://ccreater.top:61112/static/{{item}}" wx:for="{{partyDetailImageUrls}}" wx:for-item='item' wx:for-index='index' wx:key="key"  
      data-url='http://ccreater.top:61112/static/{{item}}' catchtap="previewImage"/>
    </view>

    <view class="party-detail-operation">
      <view wx:if="{{!isPublisher}}" class="joinbutton" bindtap="joinParty">{{buttonContent}}</view>
      <view wx:else class="joinbutton-gray">劳资局长</view>
      <van-notify id="van-notify" />
    </view>

  </view>

  <!-- 卡片：局内成员 -->
  <view class="partymemberview">
    <text class="party-detail-title2">局内成员</text>
    <text class="max_num">({{partyMemmberCntNow}}/{{partyMemmberCnt}})</text>
    <button class="party-moveoff-button" wx:if="{{partyOwner}}" bindtap="showMoveOff">{{moveOffButtonText}}</button>
    <view class="partymemberlist">
      
      <!-- <view class="container"> -->
        <scroll-view scroll-x="true" class="scroll">

          <view class='item-container' wx:for="{{membersInfoArr}}" wx:for-item='item' wx:for-index='index' wx:key="index">
            <view class="scroll_item">
              <van-image round width="3rem" height="3rem" src="{{item.url}}"></van-image>
              <view class="partyMemberListitemlabel {{item.isPublisher?'publisher_label':''}} {{item.myself?'myself_label':''}}">
              {{item.text}}
              </view>
              
              <view class="delete-button" wx:if="{{item.ifShow}}">
                <image src="../../../static/icons/delete.png" class="delete-button-icon" catchtap="moveOffMember" data-index="{{index}}"></image>
              </view>
          </view>
          </view>

        </scroll-view>
      <!-- </view> -->

      <!-- 局长 -->
      <!-- <view class="partymemberlistitem">
        <van-image round width="3rem" height="3rem" src="{{item.state?'https://img.yzcdn.cn/vant/cat.jpeg':'../../../../static/icons/add_post_active.png'}}">
        </van-image>
        <view class="partyMemberListitemlabel">局长</view>
      </view> -->

      <!-- 成员 -->
      <!-- <view class="partymemberlistitem" wx:for="{{partyMemberList}}" wx:for-item='item' wx:for-index='index' wx:key="key">
        <van-image round width="3rem" height="3rem" src="{{item.state?'https://img.yzcdn.cn/vant/cat.jpeg':'../../../../static/icons/add_post_active.png'}}">
        </van-image>
        <view class="partyMemberListitemlabel">成员</view>
        <view class="delete-button" wx:if="{{!item.deletable}}">
          <image src="../../../static/icons/delete.png" class="delete-button-icon" bindtap="moveOffMember" data-index="{{index}}"></image>
        </view> 
      </view> -->

    </view>
  </view>

  <!-- 卡片：拼局评论 -->
  <view class="party-comment-list">
    <text class="partydetailtitle">拼局评论</text>
    <scroll-view class="comment-list-scroll" scroll-y="true" bindscroll="onScroll" bindscrolltoupper="onTopRefresh" bindscrolltolower="onBottomRefresh">
      <v-comment bind:showCommentBox="getCommentBox" commentListData="{{partyCommentList}}">
      </v-comment>
    </scroll-view>
  </view>

</view>

<!-- 输入框 -->
<view class="comment-box">

  <form action="" class="input-form">
    <textarea  bindblur="bindTextAreaBlur" confirm-type="send" class="message-area" placeholder="{{'请输入回复'+commentMessage.publisherName+'的评论'}}" value="{{commentInputText}}" bindinput="getValue" fixed="true" cursor-spacing="30"></textarea>
    <button class="send-button" bindtap="sendComment">发送</button>
  </form>
  
</view>



